---
import BlogCard from './BlogCard.astro';
import { getCollection  } from "astro:content"

interface Props {
  posts?: Array<any>;
}

let posts = Astro.props.posts as Array<any> | undefined;

// Si no se pasan posts, obtenerlos; en cualquier caso ordenar y limitar a 4
if (!posts) {
  posts = await getCollection('posts');
}

posts = (posts ?? [])
  .slice() // no mutar el array original si vino por prop
  .sort((a, b) => {
    return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
  })
  .slice(0, 4);
---

<!-- Botón de ver todos los posts -->

<section class="py-8 md:py-12" aria-labelledby="latest-posts-title">
  <div class="px-4 mx-auto max-w-screen-xl">
    <h3 id="latest-posts-title" class="text-2xl md:text-3xl font-extrabold mb-6">
      Últimas entradas
    </h3>

    <a
        href="/blog"
        class="text-sm font-medium text-primary hover:underline"
        aria-label="Ver todas las entradas del blog"
      >
        Ver todos →
    </a>

    {posts.length === 0 ? (
      <p class="text-muted">No hay entradas disponibles.</p>
    ) : (
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mt-2">
        {posts.map(post => (
          <BlogCard post={post} />
        ))}
      </div>
    )}
  </div>
</section>